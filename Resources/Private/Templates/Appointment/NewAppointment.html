<f:layout name="Default" />

<f:section name="content">

    <f:comment><f:render partial="Error" arguments="{object:'appointment'}" /></f:comment>

    <h1>{survey.title}</h1>

    <f:if condition="{survey.appointments}">
        <h3>Bereits gewählte Termine</h3>
        <f:for each="{survey.appointments}" as="appointment">
            <p>
            <f:format.date format="d.m.Y">{appointment.appointmentDate}</f:format.date>
            </p>
            <hr>
        </f:for>
    </f:if>

    <h3>Termin hinzufügen</h3>

    <f:form class="my-form btn-group" controller="Appointment" action="createAppointment" method="post" arguments="{survey: survey, appointmentDate: appointmentDate}">
        <div class="form-inline">
            <div class="after-add-more">
                <div class="form-group">
                    <input class="form-control" type="date" placeholder="d-m-Y" name="tx_survey_surveylisting[appointmentDate][]" value="{newAppointment.appointmentDate}" />
                </div>
                <div class="form-group">
                    <f:form.button class="btn btn-default add-more" type="button">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                    </f:form.button>
                </div>
            </div>
        </div>
        <br/>
        <hr>
        <div class="form-inline form-group">
            <f:if condition="{survey.appointments}">
                <div class="form-group">
                    <f:link.action controller="Appointment" action="addFormTime" arguments="{survey: survey}" class="btn btn-default">Zurück zur Übersicht</f:link.action>
                </div>
            </f:if>
            <div class="form-group">
                <f:form.submit value="Speichern" class="btn btn-default" />
            </div>
        </div>
    </f:form>
    

    <div class="copy-fields" style="display: none!important;">
        <div class="control-group" style="margin-top:10px" >
            <div class="form-group">
                <input class="form-control" type="date" placeholder="d-m-Y" name="tx_survey_surveylisting[appointmentDate][]" value="{newAppointment.appointmentDate}" />
            </div>
            <div class="form-group">
                <f:form.button class="btn btn-default remove" type="button">
                    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                </f:form.button>
            </div>
        </div>
    </div>
    <script type="text/javascript">

        $(document).ready(function () {
            var wrapper = $("")
            //Button mit class="add-more" auswählen
            $(".add-more").click(function () {
                //speichere in var html html codeschnipsel innerhalb von class copy-fields
                var html = $(".copy-fields").html();
                //füge html codeschnipsel nach div mit class after-add-more ein
                $(".after-add-more").append(html);
            });
            //bei click auf Löschen button 
            //wird eingefügtes div mit class="copy-fields", welche die Eltern 
            //von class="control-group ist, entfernt"
            $("body").on("click", ".remove", function () {
                $(this).parents(".control-group").remove();
            });

        });

    </script>
</f:section>
